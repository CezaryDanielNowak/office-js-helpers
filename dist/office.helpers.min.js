!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.listComponent=e()}}(function(){var e;return require=function e(t,o,r){function n(a,s){if(!o[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var p=o[a]={exports:{}};t[a][0].call(p.exports,function(e){var o=t[a][1][e];return n(o?o:e)},p,p.exports,e,t,o,r)}return o[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)n(r[a]);return n}({1:[function(t,o,r){var n=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};!function(n){if("object"==typeof o&&"object"==typeof o.exports){var i=n(t,r);void 0!==i&&(o.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../authentication/endpoint.manager","../authentication/token.manager"],n)}(function(e,t){"use strict";var o=e("../authentication/endpoint.manager"),r=e("../authentication/token.manager"),i=function(e){function t(t,o){if(e.call(this,t),this.state=o,this.name="OAuthError",this.message=t,Error.captureStackTrace)Error.captureStackTrace(this,this.constructor);else{var r=new Error;if(r.stack){var n=r.stack.match(/[^\s]+$/);this.stack=this.name+" at "+n}}}return n(t,e),t}(Error);t.OAuthError=i;var a=function(){function e(e,t){this.endpoints=e,this.tokens=t,null==e&&(this.endpoints=new o.EndpointManager),null==t&&(this.tokens=new r.TokenManager)}return e.prototype.authenticate=function(t,o){void 0===o&&(o=!1);var r=this.tokens.get(t);if(null!=r&&(null!=r.expires_at&&(r.expires_at=r.expires_at instanceof Date?r.expires_at:new Date(r.expires_at),r.expires_at.getTime()-(new Date).getTime()<0&&(console.warn("Token for provider: "+t+" has expired. Re-authenticating..."),o=!0)),!o))return Promise.resolve(r);var n=this.endpoints.get(t);return null==n?Promise.reject(new i("No such registered endpoint: "+t+" could be found.")):e.hasDialogAPI?this._openInDialog(n):this._openInWindowPopup(n)},e.prototype.exchangeCodeForToken=function(e,t,o){var r=this;return new Promise(function(n,a){if(null==e.tokenUrl)return console.warn("We couldn't exchange the received code for an access_token.\n                    The value returned is not an access_token.\n                    Please set the tokenUrl property or refer to our docs."),n(t);var s=new XMLHttpRequest;s.open("POST",e.tokenUrl),s.setRequestHeader("Accept","application/json"),s.setRequestHeader("Content-Type","application/json");for(var c in o)"Accept"!==c&&"Content-Type"!==c&&s.setRequestHeader(c,o[c]);s.onerror=function(){return a(new i("Unable to send request due to a Network error"))},s.onload=function(){try{if(200===s.status){var t=JSON.parse(s.responseText);return null==t?a(new i("No access_token or code could be parsed.")):"access_token"in t?(r.tokens.add(e.provider,t),n(t)):a(new i(t.error,t.state))}if(200!==s.status)return a(new i("Request failed. "+s.response))}catch(e){return a(new i("An error occured while parsing the response"))}},s.send(JSON.stringify(t))})},e.isAuthDialog=function(){return!!e.hasDialogAPI&&(!!e.isTokenUrl(location.href)&&(Office.context.ui.messageParent(JSON.stringify(r.TokenManager.getToken())),!0))},e.isTokenUrl=function(e){var t=/(access_token|code|error)/gi;return t.test(e)},Object.defineProperty(e,"hasDialogAPI",{get:function(){if(null==e._hasDialogAPI)try{e._hasDialogAPI=window.hasOwnProperty("Office")&&(window.Office.context.requirements&&window.Office.context.requirements.isSetSupported("DialogAPI","1.1")||window.hasOwnProperty("Excel")||window.hasOwnProperty("Word")||window.hasOwnProperty("OneNote"))}catch(t){e._hasDialogAPI=!1}return e._hasDialogAPI},enumerable:!0,configurable:!0}),e.prototype._openInWindowPopup=function(e){var t=this,n=o.EndpointManager.getLoginParams(e),a=this._determineDialogSize().toPixels(),s="width="+a.width+",height="+a.height+",menubar=no,toolbar=no,location=no,resizable=yes,scrollbars=yes,status=no",c=window.open(n.url,e.provider.toUpperCase(),s);return new Promise(function(o,a){try{var s=400,u=setInterval(function(){try{if(c.document.URL.indexOf(e.redirectUrl)!==-1){clearInterval(u),c.close();var s=r.TokenManager.getToken(c.document.URL,e.redirectUrl);return null==s?a(new i("No access_token or code could be parsed.")):e.state&&+s.state!==n.state?a(new i("State couldn't be verified")):"code"in s?o(t.exchangeCodeForToken(e,s)):"access_token"in s?(t.tokens.add(e.provider,s),o(s)):a(new i(s.error,s.state))}}catch(e){if(!c)return clearInterval(u),a(new i("Popup window was closed"))}},s)}catch(e){return c.close(),a(new i("Unexpected error occured while creating popup"))}})},e.prototype._openInDialog=function(e){var t=this,r=o.EndpointManager.getLoginParams(e),n=this._determineDialogSize();return new Promise(function(o,a){Office.context.ui.displayDialogAsync(r.url,n,function(n){var s=n.value;return null==s?a(new i(n.error.message)):void s.addEventHandler(Office.EventType.DialogMessageReceived,function(n){s.close();try{if(null==n.message||""===n.message)return a(new i("No access_token or code could be parsed."));var c=JSON.parse(n.message);return e.state&&+c.state!==r.state?a(new i("State couldn't be verified")):"code"in c?o(t.exchangeCodeForToken(e,c)):"access_token"in c?(t.tokens.add(e.provider,c),o(c)):a(new i(c.error,c.state))}catch(e){return a(new i("Error while parsing response: "+JSON.stringify(e)))}})})})},e.prototype._determineDialogSize=function(){var e=window.screen.height,t=window.screen.width;return t<=640?this._createSizeObject(640,480,t,e):t<=1007?this._createSizeObject(1024,768,t,e):this._createSizeObject(1024,768,t,e)},e.prototype._createSizeObject=function(e,t,o,r){var n=function(e,t){var n=t?o:r;return e<n?e:n-30},i=function(e,t){return t?100*e/o:100*e/r};return{width:i(n(e,!0),!0),height:i(n(t,!1),!1),toPixels:function(){return{width:n(e,!0),height:n(t,!1)}}}},e}();t.Authenticator=a})},{"../authentication/endpoint.manager":2,"../authentication/token.manager":3}],2:[function(t,o,r){var n=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};!function(n){if("object"==typeof o&&"object"==typeof o.exports){var i=n(t,r);void 0!==i&&(o.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../helpers/storage"],n)}(function(e,t){"use strict";var o=e("../helpers/storage"),r=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var r=arguments.length;if(r<2||null==e)return e;t&&(e=Object(e));for(var n=1;n<r;n++){var i=arguments[n];if(null!=i)for(var a=Object.keys(i),s=a.length,c=0;c<s;c++){var u=a[c];t&&void 0!==e[u]||(e[u]=i[u])}}return e};t.DefaultEndpoints={Google:"Google",Microsoft:"Microsoft",Facebook:"Facebook",AzureAD:"AzureAD"};var i=function(e){function i(){e.call(this,"OAuth2Endpoints",o.StorageType.LocalStorage)}return n(i,e),Object.defineProperty(i.prototype,"currentHost",{get:function(){return null==this._currentHost&&(this._currentHost=window.location.protocol+"//"+window.location.host),this._currentHost},enumerable:!0,configurable:!0}),i.prototype.add=function(t,o){return null==o.redirectUrl&&(o.redirectUrl=this.currentHost),o.provider=t,e.prototype.insert.call(this,t,o)},i.prototype.registerGoogleAuth=function(e,o){var n={clientId:e,baseUrl:"https://accounts.google.com",authorizeUrl:"/o/oauth2/v2/auth",resource:"https://www.googleapis.com",responseType:"token",scope:"https://www.googleapis.com/auth/plus.me",state:!0},i=r({},o,n);return this.add(t.DefaultEndpoints.Google,i)},i.prototype.registerMicrosoftAuth=function(e,o){var n={clientId:e,baseUrl:"https://login.microsoftonline.com/common/oauth2/v2.0",authorizeUrl:"/authorize",responseType:"token",scope:"https://graph.microsoft.com/user.read",extraParameters:"&response_mode=fragment",nonce:!0,state:!0},i=r({},o,n);this.add(t.DefaultEndpoints.Microsoft,i)},i.prototype.registerFacebookAuth=function(e,o){var n={clientId:e,baseUrl:"https://www.facebook.com",authorizeUrl:"/dialog/oauth",resource:"https://graph.facebook.com",responseType:"token",scope:"public_profile",nonce:!0,state:!0},i=r({},o,n);this.add(t.DefaultEndpoints.Facebook,i)},i.prototype.registerAzureADAuth=function(e,o,n){var i={clientId:e,baseUrl:"https://login.windows.net/"+o,authorizeUrl:"/oauth2/authorize",resource:"https://graph.microsoft.com",responseType:"token",nonce:!0,state:!0},a=r({},n,i);this.add(t.DefaultEndpoints.AzureAD,a)},i.getLoginParams=function(e){var t=e.scope?encodeURIComponent(e.scope):null,o=e.resource?encodeURIComponent(e.resource):null,r=e.state&&i._generateCryptoSafeRandom(),n=e.nonce&&i._generateCryptoSafeRandom(),a=["response_type="+e.responseType,"client_id="+encodeURIComponent(e.clientId),"redirect_uri="+encodeURIComponent(e.redirectUrl)];return t&&a.push("scope="+t),o&&a.push("resource="+o),r&&a.push("state="+r),n&&a.push("nonce="+n),e.extraQueryParameters&&a.push(e.extraQueryParameters),{url:e.baseUrl+e.authorizeUrl+"?"+a.join("&"),state:r}},i._generateCryptoSafeRandom=function(){var e=new Uint32Array(1);if("msCrypto"in window)window.msCrypto.getRandomValues(e);else{if(!("crypto"in window))throw new Error("The platform doesn't support generation of Cryptographically Safe Randoms. Please disable the state flag and try again");window.crypto.getRandomValues(e)}return e[0]},i}(o.Storage);t.EndpointManager=i})},{"../helpers/storage":5}],3:[function(t,o,r){var n=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};!function(n){if("object"==typeof o&&"object"==typeof o.exports){var i=n(t,r);void 0!==i&&(o.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../helpers/storage"],n)}(function(e,t){"use strict";var o=e("../helpers/storage"),r=function(e){function t(){e.call(this,"OAuth2Tokens",o.StorageType.LocalStorage)}return n(t,e),t.prototype.setExpiry=function(e){var t=function(e){return null==e?null:new Date((new Date).getTime()+1e3*~~e)};null!=e&&null==e.expires_at&&(e.expires_at=t(e.expires_in))},t.prototype.add=function(t,o){return o.provider=t,this.setExpiry(o),e.prototype.insert.call(this,t,o)},t.getToken=function(e,t,o){void 0===e&&(e=location.href),void 0===t&&(t=location.origin),void 0===o&&(o="#"),t&&(e=e.replace(t,""));var r=e.split(o);if(!(r.length<=0)){var n=r.length>=2?r[1]:r[0];if(n=n.replace("/",""),n.indexOf("?")!==-1){var i=n.split("?");if(!i||i.length<=0)return;n=i[1]}return this._extractParams(n)}},t._extractParams=function(e){for(var t,o={},r=/([^&=]+)=([^&]*)/g;null!==(t=r.exec(e));)o[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return o},t}(o.Storage);t.TokenManager=r})},{"../helpers/storage":5}],4:[function(t,o,r){!function(n){if("object"==typeof o&&"object"==typeof o.exports){var i=n(t,r);void 0!==i&&(o.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],n)}(function(e,t){"use strict";var o=function(){function e(e){this.items=e,(this.items!==new Object(this.items)||Array.isArray(this.items))&&(this.items={})}return e.prototype.get=function(e){return this.contains(e)?this.items[e]:null},e.prototype.add=function(e,t){if(this.contains(e))throw new Error("Key: "+e+" already exists.");return this.insert(e,t)},e.prototype.insert=function(e,t){if(null==e)throw new Error("Key cannot be null or undefined");return this.items[e]=t,t},e.prototype.remove=function(e){if(!this.contains(e))throw new Error("Key: "+e+" not found.");var t=this.items[e];return delete this.items[e],t},e.prototype.clear=function(){this.items={}},e.prototype.contains=function(e){if(null==e)throw new Error("Key cannot be null or undefined");return this.items.hasOwnProperty(e)},e.prototype.keys=function(){return null==this.items?[]:Object.keys(this.items)},e.prototype.values=function(){var e=this;return this.keys().map(function(t){return e.items[t]})},e.prototype.lookup=function(){return this.keys().length?JSON.parse(JSON.stringify(this.items)):null},Object.defineProperty(e.prototype,"count",{get:function(){return this.keys().length},enumerable:!0,configurable:!0}),e}();t.Dictionary=o})},{}],5:[function(t,o,r){var n=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)};!function(n){if("object"==typeof o&&"object"==typeof o.exports){var i=n(t,r);void 0!==i&&(o.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./dictionary"],n)}(function(e,t){"use strict";var o=e("./dictionary");!function(e){e[e.LocalStorage=0]="LocalStorage",e[e.SessionStorage=1]="SessionStorage"}(t.StorageType||(t.StorageType={}));var r=t.StorageType,i=function(e){function t(t,o){e.call(this),this._container=t,this._storage=null,o=o||r.LocalStorage,this.switchStorage(o)}return n(t,e),t.prototype.switchStorage=function(e){this._storage=e===r.LocalStorage?localStorage:sessionStorage,this._storage.hasOwnProperty(this._container)||(this._storage[this._container]=null),this.load()},t.prototype.add=function(t,o){return e.prototype.add.call(this,t,o),this.save(),o},t.prototype.insert=function(t,o){return e.prototype.insert.call(this,t,o),this.save(),o},t.prototype.remove=function(t){var o=e.prototype.remove.call(this,t);return this.save(),o},t.prototype.clear=function(){e.prototype.clear.call(this),this._storage[this._container]=null},t.clearAll=function(){window.localStorage.clear(),window.sessionStorage.clear()},t.prototype.save=function(){this._storage[this._container]=JSON.stringify(this.items)},t.prototype.load=function(){return e.prototype.clear.call(this),this.items=JSON.parse(this._storage[this._container]),null==this.items&&(this.items={}),this.items},t}(o.Dictionary);t.Storage=i})},{"./dictionary":4}],"office-js-helpers":[function(t,o,r){!function(n){if("object"==typeof o&&"object"==typeof o.exports){var i=n(t,r);void 0!==i&&(o.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./helpers/dictionary","./helpers/storage","./authentication/token.manager","./authentication/endpoint.manager","./authentication/authenticator"],n)}(function(e,t){"use strict";function o(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}o(e("./helpers/dictionary")),o(e("./helpers/storage")),o(e("./authentication/token.manager")),o(e("./authentication/endpoint.manager")),o(e("./authentication/authenticator"))})},{"./authentication/authenticator":1,"./authentication/endpoint.manager":2,"./authentication/token.manager":3,"./helpers/dictionary":4,"./helpers/storage":5}]},{},[]),require("office-js-helpers")});