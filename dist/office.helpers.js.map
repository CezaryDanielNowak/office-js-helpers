{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 924630ed2fdddac0013b","webpack:///./src/index.ts","webpack:///./src/helpers/dictionary.ts","webpack:///./src/helpers/storage.ts","webpack:///./src/authentication/token.manager.ts","webpack:///./src/authentication/endpoint.manager.ts","webpack:///./src/authentication/authenticator.ts"],"names":[],"mappings":"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","file":"office.helpers.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"OfficeHelpers\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"OfficeHelpers\"] = factory();\n\telse\n\t\troot[\"OfficeHelpers\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 924630ed2fdddac0013b\n **/","// Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license.\r\n\r\nexport * from './helpers/dictionary';\r\nexport * from './helpers/storage';\r\nexport * from './authentication/token.manager';\r\nexport * from './authentication/endpoint.manager';\r\nexport * from './authentication/authenticator';\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.ts\n **/","// Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license.\r\n\r\n/**\r\n * Helper for creating and querying Dictionaries.\r\n * A rudimentary alternative to ES6 Maps.\r\n */\r\nexport class Dictionary<T> {\r\n    /**\r\n     * @constructor\r\n     * @param {object} items Initial seed of items.\r\n    */\r\n    constructor(protected items?: { [index: string]: T }) {\r\n        if (!(this.items === new Object(this.items)) || Array.isArray(this.items)) {\r\n            this.items = {};\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets an item from the dictionary.\r\n     *\r\n     * @param {string} key The key of the item.\r\n     * @return {object} Returns an item if found, else returns null.\r\n     */\r\n    get(key: string): T {\r\n        if (!this.contains(key)) {\r\n            return null;\r\n        }\r\n        return this.items[key];\r\n    }\r\n\r\n    /**\r\n     * Adds an item into the dictionary.\r\n     * If the key already exists, then it will throw.\r\n     *\r\n     * @param {string} key The key of the item.\r\n     * @param {object} value The item to be added.\r\n     * @return {object} Returns the added item.\r\n     */\r\n    add(key: string, value: T): T {\r\n        if (this.contains(key)) {\r\n            throw new Error(`Key: ${key} already exists.`);\r\n        }\r\n        return this.insert(key, value);\r\n    };\r\n\r\n    /**\r\n     * Inserts an item into the dictionary.\r\n     * If an item already exists with the same key, it will be overridden by the new value.\r\n     *\r\n     * @param {string} key The key of the item.\r\n     * @param {object} value The item to be added.\r\n     * @return {object} Returns the added item.\r\n     */\r\n    insert(key: string, value: T): T {\r\n        if (key == null) {\r\n            throw new Error('Key cannot be null or undefined');\r\n        }\r\n        this.items[key] = value;\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Removes an item from the dictionary.\r\n     * Will throw if the key doesn't exist.\r\n     *\r\n     * @param {string} key The key of the item.\r\n     * @return {object} Returns the deleted item.\r\n     */\r\n    remove(key: string): T {\r\n        if (!this.contains(key)) {\r\n            throw new Error(`Key: ${key} not found.`);\r\n        }\r\n        var value = this.items[key];\r\n        delete this.items[key];\r\n        return value;\r\n    };\r\n\r\n    /**\r\n     * Clears the dictionary.\r\n     */\r\n    clear() {\r\n        this.items = {};\r\n    }\r\n\r\n    /**\r\n     * Check if the dictionary contains the given key.\r\n     *\r\n     * @param {string} key The key of the item.\r\n     * @return {boolean} Returns true if the key was found.\r\n     */\r\n    contains(key: string): boolean {\r\n        if (key == null) {\r\n            throw new Error('Key cannot be null or undefined');\r\n        }\r\n        return this.items.hasOwnProperty(key);\r\n    }\r\n\r\n    /**\r\n     * Lists all the keys in the dictionary.\r\n     *\r\n     * @return {array} Returns all the keys.\r\n     */\r\n    keys(): string[] {\r\n        if (this.items == null) return [];\r\n        return Object.keys(this.items);\r\n    }\r\n\r\n    /**\r\n     * Lists all the values in the dictionary.\r\n     *\r\n     * @return {array} Returns all the values.\r\n     */\r\n    values(): T[] {\r\n        return this.keys().map(key => this.items[key]);\r\n    }\r\n\r\n    /**\r\n     * Get the dictionary.\r\n     *\r\n     * @return {object} Returns the dictionary if it contains data, null otherwise.\r\n     */\r\n    lookup(): { [key: string]: T } {\r\n        return this.keys().length ? JSON.parse(JSON.stringify(this.items)) : null;\r\n    }\r\n\r\n    /**\r\n     * Number of items in the dictionary.\r\n     *\r\n     * @return {number} Returns the number of items in the dictionary.\r\n     */\r\n    get count(): number {\r\n        return this.keys().length;\r\n    };\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/helpers/dictionary.ts\n **/","// Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license.\r\n\r\nimport { Dictionary } from './dictionary';\r\n\r\nexport enum StorageType {\r\n    LocalStorage,\r\n    SessionStorage\r\n}\r\n\r\n/**\r\n * Helper for creating and querying Local Storage or Session Storage.\r\n * @see Uses {@link Dictionary} to create an in-memory copy of\r\n * the storage for faster reads. Writes update the actual storage.\r\n */\r\nexport class Storage<T> extends Dictionary<T>{\r\n    private _storage = null;\r\n\r\n    /**\r\n     * @constructor\r\n     * @param {string} container Container name to be created in the LocalStorage.\r\n     * @param {StorageType} type[optional] Storage Type to be used, defaults to Local Storage.\r\n    */\r\n    constructor(private _container: string, type?: StorageType) {\r\n        super();\r\n        type = type || StorageType.LocalStorage;\r\n        this.switchStorage(type);\r\n    }\r\n\r\n    /**\r\n     * Switch the storage type.\r\n     * Switches the storage type and then reloads the in-memory collection.\r\n     *\r\n     * @type {StorageType} type The desired storage to be used.\r\n     */\r\n    switchStorage(type: StorageType) {\r\n        this._storage = type === StorageType.LocalStorage ? localStorage : sessionStorage;\r\n        if (!this._storage.hasOwnProperty(this._container)) {\r\n            this._storage[this._container] = null;\r\n        }\r\n\r\n        this.load();\r\n    }\r\n\r\n    /**\r\n     * Add an item.\r\n     * Extends Dictionary's implementation of add, with a save to the storage.\r\n     */\r\n    add(item: string, value: T): T {\r\n        super.add(item, value);\r\n        this.save();\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Add or Update an item.\r\n     * Extends Dictionary's implementation of insert, with a save to the storage.\r\n     */\r\n    insert(item: string, value: T): T {\r\n        super.insert(item, value);\r\n        this.save();\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Remove an item.\r\n     * Extends Dictionary's implementation with a save to the storage.\r\n     */\r\n    remove(item: string) {\r\n        var value = super.remove(item);\r\n        this.save();\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Clear the storage.\r\n     * Extends Dictionary's implementation with a save to the storage.\r\n     */\r\n    clear() {\r\n        super.clear();\r\n        this._storage[this._container] = null;\r\n    }\r\n\r\n    /**\r\n     * Clear all storages\r\n     * Completely clears both the localStorage and sessionStorage.\r\n     */\r\n    static clearAll() {\r\n        window.localStorage.clear();\r\n        window.sessionStorage.clear();\r\n    }\r\n\r\n    /**\r\n     * Saves the current state to the storage.\r\n     */\r\n    save() {\r\n        this._storage[this._container] = JSON.stringify(this.items);\r\n    }\r\n\r\n    /**\r\n     * Refreshes the storage with the current localStorage values.\r\n     */\r\n    load() {\r\n        super.clear();\r\n        this.items = JSON.parse(this._storage[this._container]);\r\n        if (this.items == null) this.items = {};\r\n        return this.items;\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/helpers/storage.ts\n **/","// Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license.\r\n\r\nimport { Storage, StorageType } from '../helpers/storage';\r\n\r\nexport interface IToken {\r\n    provider: string;\r\n    id_token?: string;\r\n    access_token?: string;\r\n    token_type?: string;\r\n    scope?: string;\r\n    state?: string;\r\n    expires_in?: string;\r\n    expires_at?: Date;\r\n}\r\n\r\nexport interface ICode {\r\n    provider: string;\r\n    code: string;\r\n    scope?: string;\r\n    state?: string;\r\n}\r\n\r\nexport interface IError {\r\n    error: string;\r\n    state?: string;\r\n}\r\n\r\n/**\r\n * Helper for caching and managing OAuth Tokens.\r\n */\r\nexport class TokenManager extends Storage<IToken> {\r\n    /**\r\n     * @constructor\r\n    */\r\n    constructor() {\r\n        super('OAuth2Tokens', StorageType.LocalStorage);\r\n    }\r\n\r\n    /**\r\n     * Compute the expiration date based on the expires_in field in a OAuth token.\r\n     */\r\n    setExpiry(token: IToken) {\r\n        var expire = seconds => seconds == null ? null : new Date(new Date().getTime() + ~~seconds * 1000);\r\n        if (!(token == null) && token.expires_at == null) {\r\n            token.expires_at = expire(token.expires_in);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Extends Storage's default add method\r\n     * Adds a new OAuth Token after settings its expiry\r\n     *\r\n     * @param {string} provider Unique name of the corresponding OAuth Endpoint.\r\n     * @param {object} config valid Token\r\n     * @see {@link IEndpoint}.\r\n     * @return {object} Returns the added endpoint.\r\n     */\r\n    add(provider: string, value: IToken) {\r\n        value.provider = provider;\r\n        this.setExpiry(value);\r\n        return super.insert(provider, value);\r\n    }\r\n\r\n    /**\r\n     * Extract the token from the URL\r\n     *\r\n     * @param {string} url The url to extract the token from.\r\n     * @param {string} exclude Exclude a particlaur string from the url, such as a query param or specific substring.\r\n     * @param {string} delimiter[optional] Delimiter used by OAuth provider to mark the beginning of token response. Defaults to #.\r\n     * @return {object} Returns the extracted token.\r\n     */\r\n    static getToken(url: string = location.href, exclude: string = location.origin, delimiter: string = '#'): ICode | IToken | IError {\r\n        if (exclude) url = url.replace(exclude, '');\r\n\r\n        let parts = url.split(delimiter);\r\n        if (parts.length <= 0) return;\r\n\r\n        let rightPart = parts.length >= 2 ? parts[1] : parts[0];\r\n        rightPart = rightPart.replace('/', '');\r\n\r\n        if (rightPart.indexOf(\"?\") !== -1) {\r\n            let queryPart = rightPart.split(\"?\");\r\n            if (!queryPart || queryPart.length <= 0) return;\r\n            rightPart = queryPart[1];\r\n        }\r\n\r\n        return this._extractParams(rightPart);\r\n    }\r\n\r\n    private static _extractParams(segment: string): any {\r\n        let params: any = {},\r\n            regex = /([^&=]+)=([^&]*)/g,\r\n            matches;\r\n\r\n        while ((matches = regex.exec(segment)) !== null) {\r\n            params[decodeURIComponent(matches[1])] = decodeURIComponent(matches[2]);\r\n        }\r\n\r\n        return params;\r\n    }\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/authentication/token.manager.ts\n **/","// Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license.\r\n\r\nimport { Storage, StorageType } from '../helpers/storage';\r\n\r\n// Underscore.js implementation of extend.\r\n// https://github.com/jashkenas/underscore/blob/master/underscore.js\r\nvar extend = function (obj, ...defaults) {\r\n    var length = arguments.length;\r\n    if (length < 2 || obj == null) return obj; // if there are no objects to extend then return the current object\r\n    if (defaults) obj = Object(obj); // create a new object to extend if there are any extensions\r\n\r\n    for (var index = 1; index < length; index++) {\r\n        var source = arguments[index]; // foreach object\r\n        if (source == null) continue; // move on if the object is null or undefined\r\n        var keys = Object.keys(source), // get all the keys\r\n            l = keys.length; // cache the length\r\n        for (var i = 0; i < l; i++) {\r\n            var key = keys[i]; // for each key\r\n            if (!defaults || obj[key] === void 0) obj[key] = source[key]; // replace values\r\n        }\r\n    }\r\n    return obj;\r\n};\r\n\r\nexport const DefaultEndpoints = {\r\n    Google: 'Google',\r\n    Microsoft: 'Microsoft',\r\n    Facebook: 'Facebook',\r\n    AzureAD: 'AzureAD'\r\n};\r\n\r\nexport interface IEndpoint {\r\n    /**\r\n     * Unique name for the Endpoint\r\n     */\r\n    provider?: string;\r\n\r\n    /**\r\n     * Registered OAuth ClientID\r\n     */\r\n    clientId?: string;\r\n\r\n    /**\r\n     * Base URL of the endpoint\r\n     */\r\n    baseUrl?: string;\r\n\r\n    /**\r\n     * URL segment for OAuth authorize endpoint.\r\n     * The final authorize url is constructed as (baseUrl + '/' + authorizeUrl).\r\n     */\r\n    authorizeUrl?: string;\r\n\r\n    /**\r\n     * Registered OAuth redirect url.\r\n     * Defaults to window.location.origin\r\n     */\r\n    redirectUrl?: string;\r\n\r\n    /**\r\n     * Optional token url to exchange a code with.\r\n     * Not recommended if OAuth provider supports implicit flow.\r\n     */\r\n    tokenUrl?: string;\r\n\r\n    /**\r\n     * Registered OAuth scope.\r\n     */\r\n    scope?: string;\r\n\r\n    /**\r\n     * Resource paramater for the OAuth provider.\r\n     */\r\n    resource?: string;\r\n\r\n    /**\r\n     * Automatically generate a state? defaults to false.\r\n     */\r\n    state?: boolean;\r\n\r\n    /**\r\n     * Automatically generate a nonce? defaults to false.\r\n     */\r\n    nonce?: boolean;\r\n\r\n    /**\r\n     * OAuth responseType.\r\n     */\r\n    responseType?: string;\r\n\r\n    /**\r\n     * Additional '&' separated query parameters.\r\n     */\r\n    extraQueryParameters?: string;\r\n}\r\n\r\n/**\r\n * Helper for creating and registering OAuth Endpoints.\r\n */\r\nexport class EndpointManager extends Storage<IEndpoint> {\r\n    /**\r\n     * @constructor\r\n    */\r\n    constructor() {\r\n        super('OAuth2Endpoints', StorageType.LocalStorage);\r\n    }\r\n\r\n    private _currentHost: string;\r\n    /**\r\n     * Gets the current url to be specified as the default redirect url.\r\n     */\r\n    get currentHost(): string {\r\n        if (this._currentHost == null) {\r\n            this._currentHost = window.location.protocol + \"//\" + window.location.host;\r\n        }\r\n\r\n        return this._currentHost;\r\n    }\r\n\r\n    /**\r\n     * Extends Storage's default add method.\r\n     * Registers a new OAuth Endpoint.\r\n     *\r\n     * @param {string} provider Unique name for the registered OAuth Endpoint.\r\n     * @param {object} config Valid Endpoint configuration.\r\n     * @see {@link IEndpoint}.\r\n     * @return {object} Returns the added endpoint.\r\n     */\r\n    add(provider: string, config: IEndpoint): IEndpoint {\r\n        if (config.redirectUrl == null) {\r\n            config.redirectUrl = this.currentHost;\r\n        }\r\n        config.provider = provider;\r\n        return super.insert(provider, config);\r\n    }\r\n\r\n    /**\r\n     * Register Google Implicit OAuth.\r\n     * If overrides is left empty, the default scope is limited to basic profile information.\r\n     *\r\n     * @param {string} clientId ClientID for the Google App.\r\n     * @param {object} config Valid Endpoint configuration to override the defaults.\r\n     * @return {object} Returns the added endpoint.\r\n     */\r\n    registerGoogleAuth(clientId: string, overrides?: IEndpoint) {\r\n        var defaults = <IEndpoint>{\r\n            clientId: clientId,\r\n            baseUrl: 'https://accounts.google.com',\r\n            authorizeUrl: '/o/oauth2/v2/auth',\r\n            resource: 'https://www.googleapis.com',\r\n            responseType: 'token',\r\n            scope: 'https://www.googleapis.com/auth/plus.me',\r\n            state: true\r\n        };\r\n\r\n        var config = extend({}, overrides, defaults);\r\n        return this.add(DefaultEndpoints.Google, config);\r\n    };\r\n\r\n    /**\r\n     * Register Microsoft Implicit OAuth.\r\n     * If overrides is left empty, the default scope is limited to basic profile information.\r\n     *\r\n     * @param {string} clientId ClientID for the Microsoft App.\r\n     * @param {object} config Valid Endpoint configuration to override the defaults.\r\n     * @return {object} Returns the added endpoint.\r\n     */\r\n    registerMicrosoftAuth(clientId: string, overrides?: IEndpoint) {\r\n        var defaults = <IEndpoint>{\r\n            clientId: clientId,\r\n            baseUrl: 'https://login.microsoftonline.com/common/oauth2/v2.0',\r\n            authorizeUrl: '/authorize',\r\n            responseType: 'token',\r\n            scope: 'https://graph.microsoft.com/user.read',\r\n            extraParameters: '&response_mode=fragment',\r\n            nonce: true,\r\n            state: true\r\n        };\r\n\r\n        var config = extend({}, overrides, defaults);\r\n        this.add(DefaultEndpoints.Microsoft, config);\r\n    };\r\n\r\n    /**\r\n     * Register Facebook Implicit OAuth.\r\n     * If overrides is left empty, the default scope is limited to basic profile information.\r\n     *\r\n     * @param {string} clientId ClientID for the Facebook App.\r\n     * @param {object} config Valid Endpoint configuration to override the defaults.\r\n     * @return {object} Returns the added endpoint.\r\n     */\r\n    registerFacebookAuth(clientId: string, overrides?: IEndpoint) {\r\n        var defaults = <IEndpoint>{\r\n            clientId: clientId,\r\n            baseUrl: 'https://www.facebook.com',\r\n            authorizeUrl: '/dialog/oauth',\r\n            resource: 'https://graph.facebook.com',\r\n            responseType: 'token',\r\n            scope: 'public_profile',\r\n            nonce: true,\r\n            state: true\r\n        };\r\n\r\n        var config = extend({}, overrides, defaults);\r\n        this.add(DefaultEndpoints.Facebook, config);\r\n    };\r\n\r\n    /**\r\n     * Register AzureAD Implicit OAuth.\r\n     * If overrides is left empty, the default scope is limited to basic profile information.\r\n     *\r\n     * @param {string} clientId ClientID for the AzureAD App.\r\n     * @param {string} tenant Tenant for the AzureAD App.\r\n     * @param {object} config Valid Endpoint configuration to override the defaults.\r\n     * @return {object} Returns the added endpoint.\r\n     */\r\n    registerAzureADAuth(clientId: string, tenant: string, overrides?: IEndpoint) {\r\n        var defaults = <IEndpoint>{\r\n            clientId: clientId,\r\n            baseUrl: `https://login.windows.net/${tenant}`,\r\n            authorizeUrl: '/oauth2/authorize',\r\n            resource: 'https://graph.microsoft.com',\r\n            responseType: 'token',\r\n            nonce: true,\r\n            state: true\r\n        };\r\n\r\n        var config = extend({}, overrides, defaults);\r\n        this.add(DefaultEndpoints.AzureAD, config);\r\n    };\r\n\r\n    /**\r\n     * Helper to generate the OAuth login url.\r\n     *\r\n     * @param {object} config Valid Endpoint configuration.\r\n     * @return {object} Returns the added endpoint.\r\n     */\r\n    static getLoginParams(endpointConfig: IEndpoint): {\r\n        url: string,\r\n        state: number\r\n    } {\r\n        var scope = (endpointConfig.scope) ? encodeURIComponent(endpointConfig.scope) : null;\r\n        var resource = (endpointConfig.resource) ? encodeURIComponent(endpointConfig.resource) : null;\r\n        var state = endpointConfig.state && EndpointManager._generateCryptoSafeRandom();\r\n        var nonce = endpointConfig.nonce && EndpointManager._generateCryptoSafeRandom();\r\n\r\n        var urlSegments = [\r\n            'response_type=' + endpointConfig.responseType,\r\n            'client_id=' + encodeURIComponent(endpointConfig.clientId),\r\n            'redirect_uri=' + encodeURIComponent(endpointConfig.redirectUrl)\r\n        ];\r\n\r\n        if (scope) {\r\n            urlSegments.push('scope=' + scope);\r\n        }\r\n        if (resource) {\r\n            urlSegments.push('resource=' + resource);\r\n        }\r\n        if (state) {\r\n            urlSegments.push('state=' + state);\r\n        }\r\n        if (nonce) {\r\n            urlSegments.push('nonce=' + nonce);\r\n        }\r\n        if (endpointConfig.extraQueryParameters) {\r\n            urlSegments.push(endpointConfig.extraQueryParameters);\r\n        }\r\n\r\n        return {\r\n            url: endpointConfig.baseUrl + endpointConfig.authorizeUrl + '?' + urlSegments.join('&'),\r\n            state: state\r\n        };\r\n    }\r\n\r\n    private static _generateCryptoSafeRandom() {\r\n        var random = new Uint32Array(1);\r\n        if ('msCrypto' in window) {\r\n            (<any>window).msCrypto.getRandomValues(random);\r\n        }\r\n        else if ('crypto' in window) {\r\n            window.crypto.getRandomValues(random);\r\n        }\r\n        else {\r\n            throw new Error('The platform doesn\\'t support generation of Cryptographically Safe Randoms. Please disable the state flag and try again');\r\n        }\r\n        return random[0];\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/authentication/endpoint.manager.ts\n **/","// Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license.\r\n\r\nimport { EndpointManager, IEndpoint } from '../authentication/endpoint.manager';\r\nimport { TokenManager, IToken, ICode, IError } from '../authentication/token.manager';\r\n\r\n/**\r\n * Custom error type to handle OAuth specific errors.\r\n */\r\n\r\nexport class OAuthError extends Error {\r\n    /**\r\n     * @constructor\r\n     *\r\n     * @param message Error message to be propagated.\r\n     * @param state OAuth state if available.\r\n    */\r\n    constructor(message: string, public state?: string) {\r\n        super(message);\r\n        this.name = \"OAuthError\";\r\n        this.message = message;\r\n        if ((Error as any).captureStackTrace) {\r\n            (Error as any).captureStackTrace(this, this.constructor);\r\n        }\r\n        else {\r\n            var error = new Error();\r\n            if (error.stack) {\r\n                var last_part = error.stack.match(/[^\\s]+$/);\r\n                this.stack = this.name + \" at \" + last_part;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Helper for performing Implicit OAuth Authentication with registered endpoints.\r\n */\r\nexport class Authenticator {\r\n    /**\r\n     * @constructor\r\n     *\r\n     * @param endpointManager Depends on an instance of EndpointManager.\r\n     * @param TokenManager Depends on an instance of TokenManager.\r\n    */\r\n    constructor(\r\n        public endpoints?: EndpointManager,\r\n        public tokens?: TokenManager\r\n    ) {\r\n        if (endpoints == null) this.endpoints = new EndpointManager();\r\n        if (tokens == null) this.tokens = new TokenManager();\r\n    }\r\n\r\n    /**\r\n     * Authenticate based on the given provider.\r\n     * Either uses DialogAPI or Window Popups based on where its being called from either Add-in or Web.\r\n     * If the token was cached, the it retrieves the cached token.\r\n     * If the cached token has expired then the authentication dialog is displayed.\r\n     *\r\n     * NOTE: you have to manually check the expires_in or expires_at property to determine\r\n     * if the token has expired. Not all OAuth providers support refresh token flows.\r\n     *\r\n     * @param {string} provider Link to the provider.\r\n     * @param {boolean} force Force re-authentication.\r\n     * @return {Promise<IToken|ICode>} Returns a promise of the token or code or error.\r\n     */\r\n    authenticate(provider: string, force: boolean = false): Promise<IToken> {\r\n        let token = this.tokens.get(provider);\r\n\r\n        if (token != null) {\r\n            if (token.expires_at != null) {\r\n                token.expires_at = token.expires_at instanceof Date ? token.expires_at : new Date(token.expires_at as any);\r\n                if (token.expires_at.getTime() - new Date().getTime() < 0) {\r\n                    console.warn(`Token for provider: ${provider} has expired. Re-authenticating...`);\r\n                    force = true;\r\n                }\r\n            }\r\n\r\n            if (!force) {\r\n                return Promise.resolve(token);\r\n            }\r\n        }\r\n\r\n        let endpoint = this.endpoints.get(provider);\r\n        if (endpoint == null) {\r\n            return Promise.reject(new OAuthError(`No such registered endpoint: ${provider} could be found.`)) as any;\r\n        }\r\n        else {\r\n            return (Authenticator.hasDialogAPI) ? this._openInDialog(endpoint) : this._openInWindowPopup(endpoint);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Helper for exchanging the code with a registered Endpoint.\r\n     * The helper sends a POST request to the given Endpoint's tokenUrl.\r\n     *\r\n     * The Endpoint must accept the data JSON input and return an 'access_token'\r\n     * in the JSON output.\r\n     *\r\n     * @param {Endpoint} endpoint Endpoint configuration.\r\n     * @param {object} data Data to be sent to the tokenUrl.\r\n     * @param {object} headers Headers to be sent to the tokenUrl.     *\r\n     * @return {Promise<IToken>} Returns a promise of the token or error.\r\n     */\r\n    exchangeCodeForToken(endpoint: IEndpoint, data: any, headers?: any): Promise<IToken> {\r\n        return new Promise((resolve, reject) => {\r\n            if (endpoint.tokenUrl == null) {\r\n                console.warn(\r\n                    `We couldn\\'t exchange the received code for an access_token.\r\n                    The value returned is not an access_token.\r\n                    Please set the tokenUrl property or refer to our docs.`\r\n                );\r\n                return resolve(data);\r\n            }\r\n\r\n            var xhr = new XMLHttpRequest();\r\n            xhr.open('POST', endpoint.tokenUrl);\r\n\r\n            xhr.setRequestHeader('Accept', 'application/json');\r\n            xhr.setRequestHeader('Content-Type', 'application/json');\r\n\r\n            for (var header in headers) {\r\n                if (header === 'Accept' || header === 'Content-Type') {\r\n                    continue;\r\n                }\r\n\r\n                xhr.setRequestHeader(header, headers[header]);\r\n            }\r\n\r\n            xhr.onerror = () => {\r\n                return reject(new OAuthError('Unable to send request due to a Network error'));\r\n            }\r\n\r\n            xhr.onload = () => {\r\n                try {\r\n                    if (xhr.status === 200) {\r\n                        var json = JSON.parse(xhr.responseText);\r\n                        if (json == null) {\r\n                            return reject(new OAuthError('No access_token or code could be parsed.'));\r\n                        }\r\n                        else if ('access_token' in json) {\r\n                            this.tokens.add(endpoint.provider, json)\r\n                            return resolve(json as IToken);\r\n                        }\r\n                        else {\r\n                            return reject(new OAuthError(json.error, json.state));\r\n                        }\r\n                    }\r\n                    else if (xhr.status !== 200) {\r\n                        return reject(new OAuthError('Request failed. ' + xhr.response));\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    return reject(new OAuthError('An error occured while parsing the response'));\r\n                }\r\n            };\r\n\r\n            xhr.send(JSON.stringify(data));\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Check if the currrent url is running inside of a Dialog that contains an access_token or code or error.\r\n     * If true then it calls messageParent by extracting the token information, thereby closing the dialog.\r\n     * Otherwise, the caller should proceed with normal initialization of their application.\r\n     *\r\n     * @return {boolean}\r\n     * Returns false if the code is running inside of a dialog without the required information\r\n     * or is not running inside of a dialog at all.\r\n     */\r\n    static isAuthDialog(): boolean {\r\n        if (!Authenticator.hasDialogAPI) {\r\n            return false;\r\n        }\r\n        else {\r\n            if (!Authenticator.isTokenUrl(location.href)) {\r\n                return false;\r\n            }\r\n\r\n            Office.context.ui.messageParent(JSON.stringify(TokenManager.getToken()));\r\n            return true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Check if the supplied url has either access_token or code or error.\r\n     */\r\n    static isTokenUrl(url: string) {\r\n        var regex = /(access_token|code|error)/gi;\r\n        return regex.test(url);\r\n    }\r\n\r\n    /**\r\n     * Check if the code is running inside of an Addin versus a Web Context.\r\n     * The checks for Office and Word, Excel or OneNote objects.\r\n     */\r\n    private static _hasDialogAPI: boolean;\r\n    static get hasDialogAPI() {\r\n        if (Authenticator._hasDialogAPI == null) {\r\n            try {\r\n                Authenticator._hasDialogAPI =\r\n                    window.hasOwnProperty('Office') &&\r\n                    (\r\n                        (\r\n                            (<any>window).Office.context.requirements &&\r\n                            (<any>window).Office.context.requirements.isSetSupported('DialogAPI', '1.1')\r\n                        ) ||\r\n                        window.hasOwnProperty('Excel') ||\r\n                        window.hasOwnProperty('Word') ||\r\n                        window.hasOwnProperty('OneNote')\r\n                    )\r\n            }\r\n            catch (e) {\r\n                Authenticator._hasDialogAPI = false;\r\n            }\r\n        }\r\n\r\n        return Authenticator._hasDialogAPI;\r\n    }\r\n\r\n    private _openInWindowPopup(endpoint: IEndpoint): Promise<IToken> {\r\n        let params = EndpointManager.getLoginParams(endpoint);\r\n        let windowSize = this._determineDialogSize().toPixels();\r\n        let windowFeatures = `width=${windowSize.width},height=${windowSize.height},menubar=no,toolbar=no,location=no,resizable=yes,scrollbars=yes,status=no`;\r\n        let popupWindow: Window = window.open(params.url, endpoint.provider.toUpperCase(), windowFeatures);\r\n\r\n        return new Promise<IToken>((resolve, reject) => {\r\n            try {\r\n                const POLL_INTERVAL = 400;\r\n                let interval = setInterval(() => {\r\n                    try {\r\n                        if (popupWindow.document.URL.indexOf(endpoint.redirectUrl) !== -1) {\r\n                            clearInterval(interval);\r\n                            popupWindow.close();\r\n\r\n                            let result = TokenManager.getToken(popupWindow.document.URL, endpoint.redirectUrl);\r\n                            if (result == null) {\r\n                                return reject(new OAuthError('No access_token or code could be parsed.'));\r\n                            }\r\n                            else if (endpoint.state && +result.state !== params.state) {\r\n                                return reject(new OAuthError('State couldn\\'t be verified'));\r\n                            }\r\n                            else if ('code' in result) {\r\n                                return resolve(this.exchangeCodeForToken(endpoint, (<ICode>result)));\r\n                            }\r\n                            else if ('access_token' in result) {\r\n                                this.tokens.add(endpoint.provider, result as IToken);\r\n                                return resolve(result as IToken);\r\n                            }\r\n                            else {\r\n                                return reject(new OAuthError((result as IError).error, result.state));\r\n                            }\r\n                        }\r\n                    }\r\n                    catch (exception) {\r\n                        if (!popupWindow) {\r\n                            clearInterval(interval);\r\n                            return reject(new OAuthError('Popup window was closed'));\r\n                        }\r\n                    }\r\n                }, POLL_INTERVAL);\r\n            }\r\n            catch (exception) {\r\n                popupWindow.close();\r\n                return reject(new OAuthError('Unexpected error occured while creating popup'));\r\n            }\r\n        });\r\n    }\r\n\r\n    private _openInDialog(endpoint: IEndpoint): Promise<IToken> {\r\n        let params = EndpointManager.getLoginParams(endpoint);\r\n        let windowSize = this._determineDialogSize();\r\n\r\n        return new Promise<IToken>((resolve, reject) => {\r\n            Office.context.ui.displayDialogAsync(params.url, windowSize, result => {\r\n                var dialog = result.value;\r\n                if (dialog == null) {\r\n                    return reject(new OAuthError(result.error.message));\r\n                }\r\n                dialog.addEventHandler((<any>Office).EventType.DialogMessageReceived, args => {\r\n                    dialog.close();\r\n                    try {\r\n                        if (args.message == null || args.message === '') {\r\n                            return reject(new OAuthError('No access_token or code could be parsed.'));\r\n                        }\r\n\r\n                        var json = JSON.parse(args.message);\r\n                        if (endpoint.state && +json.state !== params.state) {\r\n                            return reject(new OAuthError('State couldn\\'t be verified'));\r\n                        }\r\n                        else if ('code' in json) {\r\n                            return resolve(this.exchangeCodeForToken(endpoint, (<ICode>json)));\r\n                        }\r\n                        else if ('access_token' in json) {\r\n                            this.tokens.add(endpoint.provider, json as IToken);\r\n                            return resolve(json as IToken);\r\n                        }\r\n                        else {\r\n                            return reject(new OAuthError((json as IError).error, json.state));\r\n                        }\r\n                    }\r\n                    catch (exception) {\r\n                        return reject(new OAuthError('Error while parsing response: ' + JSON.stringify(exception)));\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    }\r\n\r\n    private _determineDialogSize() {\r\n        var screenHeight = window.screen.height;\r\n        var screenWidth = window.screen.width;\r\n\r\n        if (screenWidth <= 640) {\r\n            return this._createSizeObject(640, 480, screenWidth, screenHeight);\r\n        }\r\n        else if (screenWidth <= 1007) {\r\n            return this._createSizeObject(1024, 768, screenWidth, screenHeight);\r\n        }\r\n        else {\r\n            return this._createSizeObject(1024, 768, screenWidth, screenHeight);\r\n        }\r\n    }\r\n\r\n    private _createSizeObject(width: number, height: number, screenWidth: number, screenHeight: number) {\r\n        var minOrDefault = (value: number, isHorizontal: boolean) => {\r\n            var dimension = isHorizontal ? screenWidth : screenHeight;\r\n            return value < dimension ? value : dimension - 30;\r\n        }\r\n\r\n        var percentage = (value: number, isHorizontal: boolean) => isHorizontal ? (value * 100 / screenWidth) : (value * 100 / screenHeight);\r\n\r\n        return {\r\n            width: percentage(minOrDefault(width, true), true),\r\n            height: percentage(minOrDefault(height, false), false),\r\n            toPixels: () => {\r\n                return {\r\n                    width: minOrDefault(width, true),\r\n                    height: minOrDefault(height, false)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/authentication/authenticator.ts\n **/"],"sourceRoot":""}